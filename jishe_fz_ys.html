<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>机设辅助</title>
	<style>
		#container{
			width:500px;
			height: 250px;
			background:#ccc;
			margin: auto;
			margin-top: 100px;
		}
		path{
			fill:none;
			stroke:cornflowerblue;
			stroke-width:2px;
		}
	</style>
</head>
<body>
	
	方案：<input id="fangan" type="number" max="12" min="1" step="1" value="2"><br>
	位置：<input id="weizhi" type="number" max="14" min="0" step="1" value="10">
	<button type="button" onclick="set()">确定</button>
	<button id="ani" type="button" onclick="animates()">开始动画</button>

	<script type="text/javascript">
	    try{ 
	        document.createElement("canvas").getContext("2d"); 
	    }catch(e){ 
	        document.getElementById("support").innerHTML = 
	        "<h3>你的浏览器不支持HTML5,请安装现代化的浏览器。我们推荐使用最新版的Chrome、 FireFox</h3>"; 
	    }
 	</script>

	<!-- <iframe src="demo.svg" width="100%" height="800"></iframe> -->


	<?xml version="1.0" standalone="no"?>
	<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" 
	"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
	
	<br><button id="btnjt" onclick="hidejiantu()">隐藏运动简图</button>
	<div id="yundong" style="width:100%;height:800px;border:1px solid black">
		<svg width="100%" height="100%" version="1.1"
			xmlns="http://www.w3.org/2000/svg">

			<circle id="o3" cx="400" cy="400" r="5" stroke="black"
				stroke-width="1" fill="red"/>

			<circle id="o2" cx="600" cy="300" r="5" stroke="black"
				stroke-width="1" fill="red"/>

			<circle id="ol1" cx="600" cy="300" r="80" stroke="black"
				stroke-width="1" fill="transparent" stroke-opacity="0.5"/>

			<line id="r3" x1="400" y1="300" x2="600" y2="380"
				style="stroke:rgb(99,99,99);stroke-width:2"/>

			<line id="r3_e" x1="600" y1="380" x2="700" y2="420"
				style="stroke:rgb(99,99,99);stroke-width:2"/>

			<line id="l3" x1="400" y1="300" x2="220" y2="228"
				style="stroke:rgb(99,99,99);stroke-width:2"/>

			<rect id="rA" x="585" y="370" width="30" height="20" fill="white" stroke="black"
				transform="rotate(45,600 380)"/>

			<circle id="oA" cx="600" cy="380" r="5" stroke="black"
				stroke-width="1" fill="red"/>

			<line id="l1" x1="600" y1="300" x2="600" y2="380"
				style="stroke:rgb(99,99,99);stroke-width:2"/>

			<line id="l6" x1="200" y1="20" x2="200" y2="500"
				style="stroke:rgb(99,99,99);stroke-width:2"/>

			<line id="jxup" x1="200" y1="20" x2="300" y2="20"
				style="stroke:red;stroke-width:1"/>

			<line id="jxdw" x1="200" y1="20" x2="300" y2="20"
				style="stroke:red;stroke-width:1"/>

			<line id="qxup" x1="200" y1="20" x2="300" y2="20"
				style="stroke:blue;stroke-width:1"/>

			<line id="qxdw" x1="200" y1="20" x2="300" y2="20"
				style="stroke:blue;stroke-width:1"/>

			<circle id="oB" cx="220" cy="228" r="5" stroke="black"
				stroke-width="1" fill="red"/>

			<rect id="rC" x="185" y="90" width="20" height="30" fill="white" stroke="black"/>

			<line id="l4" x1="220" y1="228" x2="200" y2="100"
				style="stroke:rgb(99,99,99);stroke-width:2" />

			<circle id="oC" cx="200" cy="100" r="5" stroke="black"
				stroke-width="1" fill="red"/>

			<line id="la" x1="200" y1="100" x2="100" y2="100"
				style="stroke:rgb(99,99,99);stroke-width:2"/>
		</svg>	
	</div>

	<br><button id="btnsd" onclick="hidesudu()">显示速度图</button>
	<div id="sudu" style="width:100%;height:400px;border:1px solid black;display: none">
		<svg width="100%" height="100%" version="1.1"
			xmlns="http://www.w3.org/2000/svg">
			
			<line id="pa3" x1="200" y1="100" x2="100" y2="100"
			style="stroke:black;stroke-width:1"/>
			<line id="pa2" x1="200" y1="100" x2="100" y2="100"
			style="stroke:black;stroke-width:1"/>
			<line id="a2a3" x1="200" y1="100" x2="100" y2="100"
			style="stroke:black;stroke-width:1"/>
			<line id="pb" x1="200" y1="100" x2="100" y2="100"
			style="stroke:black;stroke-width:1"/>
			<line id="pc" x1="200" y1="100" x2="100" y2="100"
			style="stroke:black;stroke-width:1"/>
			<line id="bc" x1="200" y1="100" x2="100" y2="100"
			style="stroke:black;stroke-width:1"/>
			<text id="v_p" x="0" y="15" fill="black">p</text>
			<text id="v_a2" x="0" y="15" fill="black">a2</text>
			<text id="v_a3" x="0" y="15" fill="black">a3</text>
			<text id="v_b" x="0" y="15" fill="black">b</text>
			<text id="v_c" x="0" y="15" fill="black">c</text>
		</svg>
	</div>

	<br><button id="btndt" onclick="hidedata()">显示数据</button>
	<div id="data" style="width:100%;border:1px solid black;display: none">
		<!-- K:<input id="txt_K" type="number" style="width:100px">
		H:<input id="txt_H" type="number" style="width:100px">
		l<sub>6</sub>:<input id="txt_l6" type="number" style="width:100px">
		ξ:<input id="txt_Xi" type="number" style="width:100px">
		n<sub>1</sub>:<input id="txt_n1" type="number" style="width:100px"><br>
		F:<input id="txt_F" type="number" style="width:100px">
		G<sub>3</sub>:<input id="txt_G3" type="number" style="width:100px">
		G<sub>5</sub>:<input id="txt_G5" type="number" style="width:100px">
		a:<input id="txt_a" type="number" style="width:100px">
		b:<input id="txt_b" type="number" style="width:100px"><br>
		c:<input id="txt_c" type="number" style="width:100px">
		d:<input id="txt_d" type="number" style="width:100px">
		δ:<input id="txt_delta" type="number" style="width:100px">
		J<sub>S3</sub>:<input id="txt_JS3" type="number" style="width:100px"> -->
	
		l<sub>1</sub>:<input id="txt_l1" type="number" style="width:100px">
		l<sub>3</sub>:<input id="txt_l3" type="number" style="width:100px">
		l<sub>4</sub>:<input id="txt_l4" type="number" style="width:100px">
		h:<input id="txt_h" type="number" style="width:100px">
		r<sub>3</sub>:<input id="txt_r3" type="number" style="width:100px"><br>
		V<sub>a<sub>2</sub></sub><input id="txt_a2" type="number" style="width:100px">
		V<sub>a<sub>3</sub></sub><input id="txt_a3" type="number" style="width:100px">
		V<sub>b</sub><input id="txt_b" type="number" style="width:100px">
		V<sub>c</sub><input id="txt_c" type="number" style="width:100px">
		V<sub>bc</sub><input id="txt_bc" type="number" style="width:100px"><br>
		V<sub>a<sub>2</sub>a<sub>3</sub></sub><input id="txt_a3a2" type="number" style="width:100px">

		<!-- φ<sub>0</sub>:<input id="txt_Phi0" type="number" style="width:100px"><br>
		φ<sub>1</sub>:<input id="txt_phi1" type="number" style="width:100px">
		φ<sub>3</sub>:<input id="txt_phi3" type="number" style="width:100px">
		φ<sub>4</sub>:<input id="txt_phi4" type="number" style="width:100px">
		ψ:<input id="txt_Psi" type="number" style="width:100px">
		S:<input id="txt_S" type="number" style="width:100px"><br>
		x<sub>3</sub>:<input id="txt_x3" type="number" style="width:100px">
		y<sub>3</sub>:<input id="txt_y3" type="number" style="width:100px">
		θ<sub>3</sub>:<input id="txt_theta3" type="number" style="width:100px">
		r<sub>3</sub>':<input id="txt_r3_d" type="number" style="width:100px">
		r<sub>3</sub>'':<input id="txt_r3_dd" type="number" style="width:100px"><br>
		x<sub>3</sub>'':<input id="txt_x3_dd" type="number" style="width:100px">
		y<sub>3</sub>'':<input id="txt_y3_dd" type="number" style="width:100px">
		V<sub>c</sub>:<input id="txt_Vc" type="number" style="width:100px">
		x<sub>3</sub>':<input id="txt_x3_d" type="number" style="width:100px">
		y<sub>3</sub>':<input id="txt_y3_d" type="number" style="width:100px"><br>
		ω<sub>1</sub>:<input id="txt_Omega1" type="number" style="width:100px">
		ω<sub>3</sub>:<input id="txt_Omega3" type="number" style="width:100px">
		ω<sub>4</sub>:<input id="txt_Omega4" type="number" style="width:100px">
		α<sub>3</sub>:<input id="txt_Alpha3" type="number" style="width:100px">
		α<sub>4</sub>:<input id="txt_Alpha4" type="number" style="width:100px"><br>
		a<sub>c</sub>:<input id="txt_ac" type="number" style="width:100px">
		F<sub>ix3</sub>:<input id="txt_Fix3" type="number" style="width:100px">
		F<sub>iy3</sub>:<input id="txt_Fiy3" type="number" style="width:100px">
		M<sub>i3</sub>:<input id="txt_Mi3" type="number" style="width:100px">
		F<sub>i5</sub>:<input id="txt_Fi5" type="number" style="width:100px"><br>
		R<sub>34</sub>:<input id="txt_R34" type="number" style="width:100px">
		R<sub>45</sub>:<input id="txt_R45" type="number" style="width:100px">
		R<sub>65</sub>:<input id="txt_R65" type="number" style="width:100px">
		h<sub>65</sub>:<input id="txt_h65" type="number" style="width:100px">
		R<sub>12</sub>:<input id="txt_R12" type="number" style="width:100px"><br>
		X<sub>63</sub>:<input id="txt_X63" type="number" style="width:100px">
		Y<sub>63</sub>:<input id="txt_Y63" type="number" style="width:100px">
		R<sub>63</sub>:<input id="txt_R63" type="number" style="width:100px">
		M<sub>b</sub>:<input id="txt_Mb" type="number" style="width:100px">
		R<sub>61</sub>:<input id="txt_R61" type="number" style="width:100px"><br>
		M<sub>b</sub>':<input id="txt_Mb_p" type="number" style="width:100px"> -->
	</div>

	<br><br><br>
	<div id="wyqx" style="width:100%;height:500px;border:1px solid black;display: block">
		<div id="container"></div>
	</div>

<!-- 	<script src="d3/d3.js" charset="utf-8"></script> -->
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

	<script>
		function change_scale(s) {
			scale = s;
			change_fangan(fangan);
		}

		function change_fangan(){
			K = K_a[fangan];
			H = H_a[fangan] / 1000 * scale;
			l6 = l6_a[fangan] / 1000 * scale;
			Xi = Xi_a[fangan];
			n1 = n1_a[fangan];
			F = F_a[fangan];
			G3 = G3_a[fangan];
			G5 = G5_a[fangan];
			a = a_a[fangan] / 1000 * scale;
			b = b_a[fangan] / 1000 * scale;
			c = c_a[fangan] / 1000 * scale;
			d = d_a[fangan] / 1000 * scale;
			delta = delta_a[fangan];
			JS3 = JS3_a[fangan];

			Omega1 = n1 * PI / 30;

			Psi = 180 * (K - 1) / (K + 1);
			Phi0 = 270 - Psi / 2;
			
			Phi0_h = Phi0 * PI / 180;
			
			Psi_h = Psi * PI / 180;
			l1 = l6 * Math.sin(Psi_h / 2);
			l3 = H / (2 * Math.sin(Psi_h / 2));
			l4 = Xi * l3;
			h = l3 * (1 + Math.cos(Psi_h / 2)) / 2;

			o3_x = parseInt($o3.getAttribute("cx"));
			o3_y = parseInt($o3.getAttribute("cy"));
			o2_x = o3_x + l6;
			o2_y = o3_y;
			
			$ol1.setAttribute("cx",o2_x);
			$ol1.setAttribute("cy",o2_y);
			$ol1.setAttribute("r",l1);

			$o2.setAttribute("cx",o2_x);
			$o2.setAttribute("cy",o2_y);

			$l6.setAttribute("x1",o3_x - h);
			$l6.setAttribute("x2",o3_x - h);

			$oC.setAttribute("cx",o3_x - h);

			$la.setAttribute("x1",o3_x - h);
			$la.setAttribute("x2",o3_x - h - c);

			$l4.setAttribute("x2",o3_x - h);

			$l3.setAttribute("x1",o3_x);
			$l3.setAttribute("y1",o3_y);

			$l1.setAttribute("x1",o2_x);
			$l1.setAttribute("y1",o2_y);
			$l1.setAttribute("title",l1);

			$rC.setAttribute("x",o3_x - h - 10);

			$r3.setAttribute("x1",o3_x);
			$r3.setAttribute("y1",o3_y);

			jxwz();
			change_weizhi();
			var data = [];
			var oA_x_l,oA_y_l,oB_x_l,oB_y_l,oC_x_l,oC_y_l,Phi1_h_l,r3_l,k_l3_l,theta_l;
			var s_theta = 1.5 * PI - Math.asin(l1 / (o2_x - o3_x));
			var max;
			for(var i = 0; i < 360;i++){	
				if(i === 0){
					data[0] = 0;
					max = get_wy(i,s_theta);
				}else{
					data[i] = get_wy(i,s_theta) - max;
				}
			}

			change_wyqx(data);
		}

		function get_wy(phi,theta) {
			Phi1_h_l = -phi * PI / 180 - theta;
				
			r3_l = Math.pow(l1*l1 + l6*l6 + 2 * l1*l6*Math.cos(Phi1_h_l), 0.5);
			
			oA_x_l = o2_x + Math.cos(Phi1_h_l) * l1;
			oA_y_l = o2_y + Math.sin(Phi1_h_l) * l1;
			
			k_l3_l = (o3_y - oA_y_l) / (o3_x - oA_x_l);
			theta_l = Math.atan(k_l3_l);
			oB_x_l = o3_x - l3 * Math.cos(theta_l);
			oB_y_l = o3_y - l3 * Math.sin(theta_l);

			oC_x_l = o3_x - h;
			return (oB_y_l - Math.sqrt(l4*l4-Math.pow(oB_x_l - oC_x_l,2)));
		}


		function change_weizhi() {
			if (weizhi <= 11 && weizhi >= 0) {
				Phi1 = Phi0 + 30 * weizhi;
			}
			else if (weizhi == 14) {
				Phi1 = 90 + Psi / 2;
			}
			else {
				Phi1 = prompt("请输入φ1(角度)：", "");
			}
			
			change_jiaodu(Phi1);
		}

		function change_jiaodu(j){
			var l1_s = l1/scale,l3_s=l3/scale,l4_s=l4/scale,l6_s=l6/scale,h_s=h/scale;
			var a_s = a/scale,b_s=b/scale,c_s=c/scale,d_s=d/scale;

			Phi1 = j;
			Phi1_h = -Phi1 * PI / 180;
			
			r3 = Math.pow(l1*l1 + l6*l6 + 2 * l1*l6*Math.cos(Phi1_h), 0.5);
			var r3_s = r3/scale;
			// console.log(r3);
			oA_x = o2_x + Math.cos(Phi1_h) * l1;
			oA_y = o2_y + Math.sin(Phi1_h) * l1;
			
			$oA.setAttribute("cx",oA_x);
			$oA.setAttribute("cy",oA_y);

			$l1.setAttribute("x2",oA_x);
			$l1.setAttribute("y2",oA_y);

			$r3.setAttribute("x2",oA_x);
			$r3.setAttribute("y2",oA_y);

			k_l3 = (o3_y - oA_y) / (o3_x - oA_x);
			var theta = Math.atan(k_l3);
			oB_x = o3_x - l3 * Math.cos(theta);
			oB_y = o3_y - l3 * Math.sin(theta);

			$oB.setAttribute("cx",oB_x);
			$oB.setAttribute("cy",oB_y);

			$l3.setAttribute("x2",oB_x);
			$l3.setAttribute("y2",oB_y);

			oC_x = o3_x - h;
			oC_y = oB_y - Math.sqrt(l4*l4-Math.pow(oB_x - oC_x,2));

			$l4.setAttribute("x1",oB_x);
			$l4.setAttribute("y1",oB_y);
			$l4.setAttribute("y2",oC_y);

			$oC.setAttribute("cy",oC_y);
			
			$la.setAttribute("y1",oC_y);
			$la.setAttribute("y2",oC_y);

			$rC.setAttribute("y",oC_y - 15);
			$rA.setAttribute("x",oA_x - 15);
			$rA.setAttribute("y",oA_y - 10);
			$rA.setAttribute("transform","rotate("+(k_l3*180/PI)+","+oA_x+" "+oA_y+")");

			$r3_e.setAttribute("x1",oA_x);
			$r3_e.setAttribute("y1",oA_y);
			$r3_e.setAttribute("x2",oA_x+(350-r3)*Math.cos(theta));
			$r3_e.setAttribute("y2",oA_y+(350-r3)*Math.sin(theta));

			sudu();

			var y = l1_s * Math.sin(Phi1_h);
			var x = Math.pow(r3_s*r3_s - y*y, 0.5);
			if (x === 0) {
				Phi3_h = y>0 ? PI / 2 : -PI / 2;
			}else {
				Phi3_h = Math.atan(y / x);
			}

			S = -l3_s*Math.sin(Phi3_h) + Math.pow(l4_s*l4_s - Math.pow(h_s - l3_s*Math.cos(Phi3_h), 2), 0.5);
			y = l3_s*Math.sin(Phi3_h) + S;
			x = l3_s*Math.cos(Phi3_h) - h_s;
			if(x === 0) {
				Phi4_h = y>0 ? PI / 2 : -PI / 2;
			}else{
				Phi4_h = Math.atan(y / x);
				if(x < 0) {
					if(y >= 0) {
						Phi4_h += PI;
					}else{
						Phi4_h -= PI;
					}
				}
			}

			if(a_s == d_s) {
				theta3_h = a_s>0 ? PI / 2 : -PI / 2;
			}else{
				theta3_h = Math.atan(a_s / Math.pow(d_s*d_s - a_s*a_s, 0.5));
			}

			x3 = h_s + d_s * Math.cos(theta3_h + Phi3_h);
			y3 = d_s * Math.sin(theta3_h + Phi3_h);

			shuju();
		}

		function jxwz() {
			//上极限位置
			var Phi1_h = Phi0 * PI / 180;
			
			var oA_x = o2_x + Math.cos(Phi1_h) * l1;
			var oA_y = o2_y - Math.sin(Phi1_h) * l1;
			
			var l3_k = (o3_y - oA_y) / (o3_x - oA_x);
			var theta = Math.atan(l3_k);
			var	oB_x = o3_x - l3 * Math.cos(theta);
			var	oB_y = o3_y - l3 * Math.sin(theta);

			var oC_x = o3_x - h;
			var oC_y = oB_y - Math.sqrt(l4*l4-Math.pow(oB_x - oC_x,2));

			jxup = oC_y;
			//下极限位置
			jxdw = jxup + H;
			qxup = jxup + 0.05 * H;
			qxdw = jxdw - 0.05 * H;

			var $jxup = document.getElementById("jxup");
			var $jxdw = document.getElementById("jxdw");
			var $qxup = document.getElementById("qxup");
			var $qxdw = document.getElementById("qxdw");

			setjxwz($jxup,oC_x,jxup,20);
			setjxwz($jxdw,oC_x,jxdw,20);
			setjxwz($qxup,oC_x,qxup,20);
			setjxwz($qxdw,oC_x,qxdw,20);
		}

		function setjxwz(l,x,y,len){
			l.setAttribute("x1",x);
			l.setAttribute("y1",y);
			l.setAttribute("x2",x+len);
			l.setAttribute("y2",y);
		}

		function set(){
			clearInterval(interval);
			if(isBeginAni){
				isBeginAni = false;
				document.getElementById("ani").innerText="开始动画";
			}
			fangan = parseInt(document.getElementById("fangan").value) - 1;
			weizhi = parseInt(document.getElementById("weizhi").value);
			
			change_fangan();
		}

		function animates(){
			if(isBeginAni){
				clearInterval(interval);
				isBeginAni = false;
				document.getElementById("ani").innerText="开始动画";
			}else{
				isBeginAni = true;
				var delay = 100/Omega1;
				// console.log(delay);
				document.getElementById("ani").innerText="停止动画";
				interval = setInterval(function() {
					change_jiaodu(Phi1);
					Phi1 = Phi1 + 0.1*180/PI;
					Phi1_h = Phi1_h - 0.1;
				},delay);
			}
		}

		function sudu(){
			var scale_sudu = 50;
			var op_x = 200,op_y = 200;
			var a2_x,a2_y,a3_x,a3_y,b_x,b_y,c_x,c_y;
			var vA2 = Omega1 * l1 / scale * scale_sudu;

			var vA3,vA3A2,vb;
			var theta_pa2 = (Phi1_h - PI / 2) % (2 * PI);
			a2_x = op_x + vA2 * Math.cos(theta_pa2);
			a2_y = op_y + vA2 * Math.sin(theta_pa2);

			var theta_pa3 = Math.atan(-1/k_l3);
			console.log(theta_pa2);
			console.log(theta_pa3);
			var theta_pa3a2 = Math.abs(theta_pa2 - theta_pa3) % (PI * 2);
			// if(theta_pa3a2 > PI / 2){
			console.log(theta_pa3a2);
			// 	theta_pa3a2 = theta_pa3a2 % (PI/2);
			// }
			if(theta_pa3a2 > 1.5*PI){
				theta_pa3a2 = PI * 2 - theta_pa3a2;
			}else if(theta_pa3a2>PI && theta_pa3a2 < 1.5 * PI){
				theta_pa3 = theta_pa3 + PI;
				theta_pa3a2 = theta_pa3a2 - PI;	
			}else if(theta_pa3a2 > PI/2 && theta_pa3a2 < PI){
				theta_pa3 = theta_pa3 + PI;
				theta_pa3a2 = PI - theta_pa3a2;
			}
			console.log(theta_pa3a2);


			vA3 = vA2 * Math.cos(theta_pa3a2);
			a3_x = op_x + vA3 * Math.cos(theta_pa3);
			a3_y = op_y + vA3 * Math.sin(theta_pa3);

			vb = vA3 * (l3 / r3);
			b_x = op_x + vb * Math.cos(theta_pa3+PI);
			b_y = op_y + vb * Math.sin(theta_pa3+PI);

			c_x = op_x;
			// c_y = op_y + vb / Math.cos(PI/2+theta_pa3);
			c_y = b_y + (oB_x - oC_x)/(oC_y - oB_y)*(op_x-b_x);

			$v_p.setAttribute("x",op_x);
			$v_p.setAttribute("y",op_y);

			$v_a2.setAttribute("x",a2_x);
			$v_a2.setAttribute("y",a2_y);

			$v_a3.setAttribute("x",a3_x);
			$v_a3.setAttribute("y",a3_y);

			$v_b.setAttribute("x",b_x);
			$v_b.setAttribute("y",b_y);

			$v_c.setAttribute("x",c_x);
			$v_c.setAttribute("y",c_y);

			$pa2.setAttribute("x1",op_x);
			$pa2.setAttribute("y1",op_y);
			$pa2.setAttribute("x2",a2_x);
			$pa2.setAttribute("y2",a2_y);

			$pa3.setAttribute("x1",op_x);
			$pa3.setAttribute("y1",op_y);
			$pa3.setAttribute("x2",a3_x);
			$pa3.setAttribute("y2",a3_y);

			$a2a3.setAttribute("x1",a2_x);
			$a2a3.setAttribute("y1",a2_y);
			$a2a3.setAttribute("x2",a3_x);
			$a2a3.setAttribute("y2",a3_y);
			
			$pb.setAttribute("x1",op_x);
			$pb.setAttribute("y1",op_y);
			$pb.setAttribute("x2",b_x);
			$pb.setAttribute("y2",b_y);

			$pc.setAttribute("x1",op_x);
			$pc.setAttribute("y1",op_y);
			$pc.setAttribute("x2",c_x);
			$pc.setAttribute("y2",c_y);

			$bc.setAttribute("x1",b_x);
			$bc.setAttribute("y1",b_y);
			$bc.setAttribute("x2",c_x);
			$bc.setAttribute("y2",c_y);

			$txt_Va3.value=vA3/scale_sudu;
			$txt_Va2.value=vA2/scale_sudu;
			$txt_Vb.value=vb/scale_sudu;
			$txt_Vc.value=(Math.pow(Math.pow(c_x - op_x,2)+Math.pow(c_y - op_y,2),0.5))/scale_sudu;
			$txt_Vbc.value=(Math.pow(Math.pow(c_x - b_x,2)+Math.pow(c_y - b_y,2),0.5))/scale_sudu;
			$txt_Va3a2.value=(Math.pow(Math.pow(a2_x - a3_x,2)+Math.pow(a2_y - a3_y,2),0.5))/scale_sudu;
		}

		function shuju(){
			// document.getElementById("txt_K").value=K;
			// document.getElementById("txt_H").value=H/scale;
			// document.getElementById("txt_l6").value=l6/scale;
			// document.getElementById("txt_Xi").value=Xi;
			// document.getElementById("txt_n1").value=n1;
			// document.getElementById("txt_F").value=F;
			// document.getElementById("txt_G3").value=G3;
			// document.getElementById("txt_G5").value=G5;
			// document.getElementById("txt_a").value=a/scale;
			// document.getElementById("txt_b").value=b/scale;
			// document.getElementById("txt_c").value=c/scale;
			// document.getElementById("txt_d").value=d/scale;
			// document.getElementById("txt_delta").value=delta;
			// document.getElementById("txt_JS3").value=JS3;

			document.getElementById("txt_l1").value=l1/scale;
			document.getElementById("txt_l3").value=l3/scale;
			document.getElementById("txt_l4").value=l4/scale;
			document.getElementById("txt_h").value=h/scale;
			document.getElementById("txt_r3").value=r3/scale;

			// document.getElementById("txt_Phi0").value=Phi0_h;
			// document.getElementById("txt_phi1").value=Phi1_h;
			// document.getElementById("txt_phi3").value=Phi3_h;
			// document.getElementById("txt_phi4").value=Phi4_h;
			// document.getElementById("txt_Psi").value=Psi_h;
			// document.getElementById("txt_S").value=S;
			// document.getElementById("txt_x3").value=x3;
			// document.getElementById("txt_y3").value=y3;
			// document.getElementById("txt_theta3").value=theta3_h;
			// document.getElementById("txt_r3_d").value=r3_d;
			// document.getElementById("txt_r3_dd").value=r3_dd;
			// document.getElementById("txt_x3_dd").value=x3_dd;
			// document.getElementById("txt_y3_dd").value=y3_dd;
			// document.getElementById("txt_x3_d").value=x3_d;
			// document.getElementById("txt_y3_d").value=y3_d;
			// document.getElementById("txt_Omega1").value=Omega1;
			// document.getElementById("txt_Omega3").value=Omega3;
			// document.getElementById("txt_Omega4").value=Omega4;
			// document.getElementById("txt_Alpha3").value=Alpha3;
			// document.getElementById("txt_Alpha4").value=Alpha4;
			// document.getElementById("txt_ac").value=ac;
			// document.getElementById("txt_Fix3").value=Fix3;
			// document.getElementById("txt_Fiy3").value=Fiy3;
			// document.getElementById("txt_Mi3").value=Mi3;
			// document.getElementById("txt_Fi5").value=Fi5;
			// document.getElementById("txt_R34").value=R34;
			// document.getElementById("txt_R45").value=R45;
			// document.getElementById("txt_R65").value=R65;
			// document.getElementById("txt_h65").value=h65;
			// document.getElementById("txt_R12").value=R12;
			// document.getElementById("txt_X63").value=X63;
			// document.getElementById("txt_Y63").value=Y63;
			// document.getElementById("txt_R63").value=R63;
			// document.getElementById("txt_Mb").value=Mb;
			// document.getElementById("txt_R61").value=R61;
			// document.getElementById("txt_Mb_p").value=Mb_p;



		}

		function hidejiantu(){
			if(document.getElementById("btnjt").innerText == "隐藏运动简图"){
				document.getElementById("btnjt").innerText = "显示运动简图";
				document.getElementById("yundong").style.display="none";
			}else{
				document.getElementById("btnjt").innerText = "隐藏运动简图";
				document.getElementById("yundong").style.display="block";
			}
		}

		function hidesudu() {
			if(document.getElementById("btnsd").innerText == "隐藏速度图"){
				document.getElementById("btnsd").innerText = "显示速度图";
				document.getElementById("sudu").style.display="none";
			}else{
				document.getElementById("btnsd").innerText = "隐藏速度图";
				document.getElementById("sudu").style.display="block";
			}
		}

		function hidedata() {
			if(document.getElementById("btndt").innerText == "隐藏数据"){
				document.getElementById("btndt").innerText = "显示数据";
				document.getElementById("data").style.display="none";
			}else{
				document.getElementById("btndt").innerText = "隐藏数据";
				document.getElementById("data").style.display="block";
			}
		}
		//位移曲线
		function change_wyqx(data) {
			var width = 500,height = 250, margin = {left:50,top:30,right:20,bottom:20},
			g_width = width - margin.left - margin.right,
			g_height = height - margin.top - margin.bottom;

			d3.select("#container svg").remove();
			var svg = d3.select("#container")
			.append("svg:svg")
			.attr("width",width)
			.attr("height",height);

			var scale_x = d3.scaleLinear()
			.domain([0,data.length-1])
			.range([0,g_width]);

			var scale_y = d3.scaleLinear()
			.domain([d3.min(data),d3.max(data)])
			.range([g_height,0]);

			var axis_x = d3.axisBottom()
			.scale(scale_x) //指定比例尺
			.ticks(20);

			var axis_y = d3.axisLeft()
			.scale(scale_y) //指定比例尺
			.ticks(7);

			var line_generator = d3.line()
			.x(function(d,i) {return scale_x(i);})
			.y(function(d) {return scale_y(d);})
			.curve(d3.curveBasis);

			d3.select("#container svg")
			.append("g")
			.attr("id","wydataVis")
			.attr("transform","translate("+margin.left+","+margin.top+")");
			// .attr("transform","rotate(180,"+(margin.left+g_width/2)+" "+ (margin.top+g_height/2)+")");
			// .call(axis_y);

			d3.select("#container svg")
			.append("g")
			.call(axis_x)
			.attr("transform","translate("+margin.left+","+(margin.top+g_height)+")");

			d3.select("#container svg")
			.append("g")
			.call(axis_y)
			.attr("transform","translate("+margin.left+","+(margin.top)+")");

			d3.select("#wydataVis")
			.append("path")
			.attr("d",line_generator(data));
		}

		var K_a = new Array(1.9,2.4,1.5,1.5,1.5,1.5,1.5,1.8,2.1,1.9,1.7,2.2);
		var H_a = new Array(100,150,160,140,110,135,120,110,120,130,200,220);
		var l6_a = new Array(150,185,200,180,170,140,160,170,160,150,210,230);
		var Xi_a = new Array(1,0.8,1.0,0.8,1.0,1.1,1,0.9,1.1,0.85,0.9,1.0);
		var n1_a = new Array(120,120,140,150,130,140,130,130,140,130,300,400);
		var F_a = new Array(1200,1000,1200,1400,1300,1200,1300,1100,1300,1400,2000,3000);
		var G3_a = new Array(160,200,170,160,190,200,190,170,150,180,160,165);
		var G5_a = new Array(320,360,330,400,380,400,410,330,320,340,400,500);
		var a_a = new Array(50,65,45,55,50,70,50,70,55,60,50,45);
		var b_a = new Array(50,70,70,60,50,60,60,60,55,65,60,55);
		var c_a = new Array(120,160,120,110,130,140,100,130,140,150,130,120);
		var d_a = new Array(125,130,135,120,130,140,110,140,150,150,140,130);
		var delta_a = new Array(0.04,0.03,0.02,0.05,0.06,0.05,0.04,0.05,0.03,0.06,0.03,0.02);
		var JS3_a = new Array(0.14,0.3,0.4,0.3,0.25,0.5,0.45,0.2,0.35,0.25,0.4,0.5);
		// var svg = document.getElementsByTagName('iframe')[0].getSVGDocument();
		// console.log(svg);
		var K, H, l6, Xi, n1, F, G3, G5, a, b, c, d, delta, JS3;
		var Phi0, Phi0_h, Phi1, Phi1_h, Phi3, Phi3_h, Phi4, Phi4_h; //φ
		var Psi, Psi_h; //Ψ
		var l1, l3, l4, h, r3, S, x3, y3, theta3_h;
		var r3_d, r3_dd, x3_dd, y3_dd, Vc, x3_d, y3_d;
		var Omega1, Omega3, Omega4, Alpha3, Alpha4, ac;
		var g = 9.8,PI = 3.1416;
		var Fix3, Fiy3, Mi3, Fi5, R34, R45, R65, h65, R12, X63, Y63, R63, Mb, R61, Mb_p;

		var o3_x, o3_y, o2_x, o2_y,oA_x,oA_y,oB_x,oB_y,oC_x,oC_y;
		var jxup,jxdw,qxup,qxdw;

		var k_l3,k_l1,k_l4;

		var scale = 1000;
		var fangan,weizhi;

		//简图
		var $l1 = document.getElementById("l1");
		var $l6 = document.getElementById("l6");
		var $l3 = document.getElementById("l3");
		var $l4 = document.getElementById("l4");
		var $r3 = document.getElementById("r3");
		var $o2 = document.getElementById("o2");
		var $o3 = document.getElementById("o3");
		var $ol1 = document.getElementById("ol1");
		var $oA = document.getElementById("oA");
		var $oB = document.getElementById("oB");
		var $oC = document.getElementById("oC");
		var $la = document.getElementById("la");
		var $rC = document.getElementById("rC");
		var $rA = document.getElementById("rA");
		var $r3_e = document.getElementById("r3_e");

		//速度
		var $pa2 = document.getElementById("pa2");
		var $pa3 = document.getElementById("pa3");
		var $a2a3 = document.getElementById("a2a3");
		var $pb = document.getElementById("pb");
		var $pc = document.getElementById("pc");
		var $bc = document.getElementById("bc");

		var $v_p = document.getElementById("v_p");
		var $v_a2 = document.getElementById("v_a2");
		var $v_a3 = document.getElementById("v_a3");
		var $v_b = document.getElementById("v_b");
		var $v_c = document.getElementById("v_c");

		// 数据
		var $txt_Vc = document.getElementById("txt_c");
		var $txt_Vb = document.getElementById("txt_b");
		var $txt_Va3 = document.getElementById("txt_a3");
		var $txt_Va2 = document.getElementById("txt_a2");
		var $txt_Va3a2 = document.getElementById("txt_a3a2");
		console.log($txt_Va3a2);
		var $txt_Vbc = document.getElementById("txt_bc");


		var interval;
		var isBeginAni = false;
		set();
	</script>
</body>
</html>
